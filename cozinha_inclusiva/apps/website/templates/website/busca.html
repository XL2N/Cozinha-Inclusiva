{% extends "base.html" %}
{% block title %}{{ termo }} - Cozinha Inclusiva{% endblock %}
{% load static %}

{% block extra_style %}
<link rel="stylesheet" href="{% static 'css/website/busca.css' %}">
{% endblock %}

{% block content %}
<div class="m-5 p-5 rounded-4 shadow-sm bg-white mx-auto position-relative" style="max-width: 1220px;">

    <!-- Título da Busca -->
    <div class="busca-header">
        {% if termo %}
        <p class="busca-label">Tudo que encontramos por:</p>
        <h2 class="busca-termo">{{ termo }}</h2>
        {% else %}
        <p class="busca-label">Buscar Receitas</p>
        <h2 class="busca-termo">Digite o nome de uma receita, ingrediente ou categoria</h2>
        {% endif %}
    </div>

    <!-- Resultados da Busca -->
    {% if receitas %}
    <div class="busca-resultados">
        {% for receita in receitas %}
        <a href="{% url 'receita_selecionada' receita.id %}" class="receita-item">
            <!-- IMAGEM CAPA -->
            <div class="receita-imagem">
                {% if receita.imagem_capa %}
                <img src="{{ receita.imagem_capa.url }}" alt="{{ receita.titulo }}">
                {% else %}
                <img src="{% static 'image/default/default_recipe.png' %}" alt="Imagem padrão">
                {% endif %}
            </div>
            
            <!-- CONTEÚDO -->
            <div class="receita-conteudo">
                <h3 class="receita-titulo">{{ receita.titulo }}</h3>
                <p class="receita-descricao">{{ receita.descricao }}</p>
                
                <!-- RESTRIÇÕES -->
                <div class="receita-restricoes">
                    <strong>Restrições:</strong>
                    {% if receita.categoria.all %}
                        {% for cat in receita.categoria.all %}
                            {{ cat.nome|lower }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    {% else %}
                        Nenhuma restrição
                    {% endif %}
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    {% elif termo %}
    <div class="busca-vazia">
        <i class="fa-solid fa-magnifying-glass"></i>
        <h3>Nenhuma receita encontrada</h3>
        <p>Tente buscar por outro termo</p>
        <a href="{% url 'inicio' %}" class="btn-voltar-inicio">
            Voltar para o início
        </a>
    </div>
    {% endif %}
</div>

{% endblock %}